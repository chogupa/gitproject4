<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<title>ゲーム画面</title>
	<link rel="stylesheet" href="../../static/style.css" th:href="@{/style.css}">
</head>

<body>
	<table>
	    <tr th:each="row : ${#numbers.sequence(0,4)}">
	      <td th:each="col : ${#numbers.sequence(0,4)}"
	          th:attr="data-id=${dbList[row * 5 + col].id}"
	          th:text="' '">
	      </td>
	    </tr>
	  </table>

	  <script>
		//全てのマスを取得する
	    document.querySelectorAll('td[data-id]').forEach(td => {
	      const id = td.getAttribute('data-id') //マスのID取得

	      let revealed = false; //マスが開いてるか
	      let flagged = false; //旗が立っているか

	      // 左クリックで開く
	      td.addEventListener('click', () => {
	        if (revealed || flagged) return; // すでに開いてる・旗ある
	        revealed = true;
	        td.classList.add(''); //cssクラス名挿入、マスの見た目変更
	        td.textContent = id;  // 仮にidを中身として表示
	      });

	      // 右クリックで旗を立てる
	      td.addEventListener('contextmenu', e => {
	        e.preventDefault(); //メニュー出ないように
	        if (revealed) return; 

	        flagged = !flagged; //旗を立てる・外す
	        if (flagged) {
	          td.classList.add('flagged');
	          td.textContent = '🚩';
	        } else {
	          td.classList.remove('flagged');
	          td.textContent = '';
	        }
	      });
	    });
	  </script>

	</body>

	</html>